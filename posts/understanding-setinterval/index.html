<!DOCTYPE html><html><head><meta charset="utf-8"><link href="/img/favicon.png" rel="shortcut icon"><link href="/img/apple-touch-icon-precomposed.png" rel="apple-touch-icon"><meta name="HandheldFriendly" content="True"><meta name="MobileOptimized" content="320"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Understanding setInterval - Taylor Hakes</title><meta name="description" content="If you write a lot of Javascript, inevitably you find the need to use the functions setTimeout or setInterval."><meta name="twitter:card" content="summary"><meta name="twitter:site" content="Taylor Hakes"><meta name="twitter:title" content="Understanding setInterval"><meta name="twitter:description" content="If you write a lot of Javascript, inevitably you find the need to use the functions setTimeout or setInterval."><meta name="twitter:creator" content="Taylor Hakes"><meta property="og:type" content="article"><meta property="og:title" content="Understanding setInterval"><meta property="og:description" content="&lt;p&gt;If you write a lot of Javascript, inevitably you find the need to use the functions setTimeout or setInterval.&lt;br&gt;"><meta property="og:site_name" content="Taylor Hakes"><link rel="stylesheet" type="text/css" href="//fonts.googleapis.com/css?family=Merriweather:300,700,700italic,300italic|Open+Sans:700,400"><link rel="stylesheet" type="text/css" href="/css/bootstrap.min.css"><link rel="stylesheet" type="text/css" href="/css/font-awesome.min.css"><link rel="stylesheet" type="text/css" href="/css/magnific-popup.css"><link rel="stylesheet" type="text/css" href="/css/YTPlayer.css"><link rel="stylesheet" type="text/css" href="/css/style.css"><link rel="stylesheet" type="text/css" href="/css/colors/default.css"><link rel="stylesheet" type="text/css" href="/css/monokai-sublime.css"></head><body data-site-layout="wide" data-post-mode="multimedia" data-post-align="center" data-uppercase="true" class="post-template"><div id="fb-root"></div><!--[if lt IE 9]
<div class="outdated-frame">
  You are using an <strong>outdated</strong> span browser. Please <a href="http://www.google.com/chrome/intl/en/landing_chrome.html">upgrade your browser</a>
</div>
![endif]--><div class="body-wrap"><div data-layout="wide" data-sticky="false" data-color-scheme="light" data-direction="default" class="header header-full-screen-center-logo"><div class="header-wrap"><div class="nav-container"><a href="javascript:;" class="mini-nav-button"><span>navigation</span></a></div><div class="addition-container"><ul class="social"><li class="github"><a href="https://github.com/taylorhakes" target="_blank" title="github"><i class="fa fa-github"></i></a></li><li class="twitter"><a href="https://twitter.com/TaylorHakes" target="_blank" title="twitter"><i class="fa fa-twitter"></i></a></li><li class="linkedin"><a href="https://www.linkedin.com/in/taylorhakes" target="_blank" title="linkedin"><i class="fa fa-linkedin"></i></a></li></ul></div></div></div><div class="full-screen-nav"><div class="full-screen-nav-wrap"><div class="full-screen-nav-wrap-inner"><ul class="full-screen-nav-items"><li class="active"><a href="/">Home</a></li></ul></div></div></div><div class="search-container"><div class="search-container-wrap"><div class="search-container-wrap-inner"><div class="search-box"><h3 class="search-label">Search</h3><input id="search-keyword" type="search" name="search-keyword" placeholder="Type and hit enter!"><ul class="search-result"></ul></div></div></div></div><div class="main-wrap"><main role="main" class="body-content"><section itemscope="itemscope" itemtype="http://schema.org/BlogPosting" role="article" class="post formatted has-sub-meta"><div style="" class="post-header"><div class="header-wrap"><h1 itemprop="name headline" class="post-title">Understanding setInterval</h1><div class="post-meta">By Taylor Hakes -<time datetime="Sun Nov 10 2013 00:00:00 GMT-0500" itemprop="datePublished"> Nov 10, 2013</time><div class="line"></div></div></div></div><div itemprop="articleBody" class="post-content"><div><p>If you write a lot of Javascript, inevitably you find the need to use the functions setTimeout or setInterval.<br><a id="more"></a><br>setTimeout executes a function after a given number of milliseconds and setInterval executes a function forever at a given interval. You can read more about them here (<a href="https://developer.mozilla.org/en-US/docs/Web/API/Window.setTimeout" target="_blank" rel="external">setTimeout</a> and <a href="https://developer.mozilla.org/en-US/docs/Web/API/Window.setInterval" target="_blank" rel="external">setInterval</a>).</p>
<p>Most developers use them, but don’t really understand what is going on behind the scenes. An interesting explanation came from <a href="http://ejohn.org/blog/how-javascript-timers-work/" target="_blank" rel="external">John Resig’s blog</a>. I originally took the information as fact without doing my own investigation. About a year ago AppNexus decided to give an interview question on setInterval. My colleague, Sam Mati, and I decided to do some tests on setInterval. Interestingly, we found John’s model of setInterval to be wrong.</p>
<p>Here is the important diagram from John’s blog post. Notice that setInterval’s function is always placed on the event stack at 10ms intervals from the original execution time. If another event takes too much time, only one setInterval function will remain in the queue at a time.</p>
<p><a href="http://ejohn.org/blog/how-javascript-timers-work/" target="_blank" rel="external"><img class="alignnone size-full wp-image-35" alt="timers" src="http://i2.wp.com/ejohn.org/files/Timers.png" width="427" height="320"></a></p>
<p>We decided to create a simple test. The code executes a setInterval at a 1 second interval and then has code that runs for 1.5 seconds.<br><a href="http://jsfiddle.net/2VeYC/" target="_blank" rel="external">http://jsfiddle.net/2VeYC/</a></p>
<p><pre><br><code class="javascript">var start = new Date();</code></pre></p>
<p>// Mimics a long running call for a number of milliseconds<br>function waitMilliseconds(milliseconds) {<br>  var start = +(new Date());<br>  while(start + milliseconds &gt; +(new Date())) {}<br>}</p>
<p>// First setInterval call. console.log the time<br>setInterval(function() {<br>  var current = new Date();<br>  console.log(‘setInterval executing: ‘ + (current - start));<br>}, 1000);</p>
<p>// Some code that takes a while to run<br>var current = new Date();<br>console.log(‘start long running code: ‘ + (current - start));<br>waitMilliseconds(1500);<br>current = new Date();<br>console.log(‘end long running code: ‘ + (current - start));<br><br>If John’s explanation was correct, we should see something like this. The first setInterval would take 1.5 seconds (because of the slow code), the second would take .5 seconds to get back in sync (with the original call) and then after it would continue at 1s intervals.</p>
<p><pre><br><code class="javascript">start long running code: 0<br>end long running code: 1500<br>setInterval executing: 1501<br>setInterval executing: 2000<br>setInterval executing: 3000<br></code></pre><br>The actual results</p>
<p><pre><br><code class="javascript">start long running code: 0<br>end long running code: 1503<br>setInterval executing: 1505<br>setInterval executing: 2505<br>setInterval executing: 3507</code><br></pre><br>It appears that setInterval executes at the interval based on the last time it was executed. Essentially it behaves equivalent to this code. <a href="http://jsfiddle.net/u8SgN/" target="_blank" rel="external">http://jsfiddle.net/u8SgN/</a></p>
<p><pre><br><code class="javascript">// Recreation of setInterval<br>function pseudoSetInterval(fn, time /<em> [, param1, param2, …]</em>/) {<br>    var args = Array.prototype.slice.call(arguments,2);<br>    setTimeout(function interval() {<br>        setTimeout(interval, time);<br>        fn.apply(window, args);<br>    }, time);<br>}</code></pre><br>To make sure that was correct, we created another test with only setInterval. We added long running code of 1.5s to setInterval. <a href="http://jsfiddle.net/FQFGM/" target="_blank" rel="external">http://jsfiddle.net/FQFGM/</a></p>
<p><pre><br><code class="javascript">// Get the start of code execution<br>var start = new Date();</code></pre></p>
<p>// Mimics a long running call for a number of milliseconds<br>function waitMilliseconds(milliseconds) {<br>  var start = +(new Date());<br>  while(start + milliseconds &gt; +(new Date())) {}<br>}</p>
<p>var first = true;<br>setInterval(function() {<br>    var current = new Date();<br>    console.log(‘setInterval executing: ‘ + (current - start));</p>
<pre><code>// Make the first execution take 1.5 seconds
if (first) {
    waitMilliseconds(1500);
    first = false;
}
</code></pre><p>}, 1000);<br><br>Here are the results. It has the same result.</p>
<p><pre><br><code class="javascript">setInterval executing: 1001<br>setInterval executing: 2504<br>setInterval executing: 3505<br>setInterval executing: 4506<br></code></pre><br>This result will not impact most javascript developers, but for games, animations, etc. it is important to know exactly how javascript’s events work.</p>
</div><div class="share-box"><div class="share-box-wrap"><h3 class="box-title">Thanks for reading!<span class="box-sub-title">Don't forget to spread the word:</span><ul class="social"><li class="github"><a href="https://github.com/taylorhakes" target="_blank" title="github"><i class="fa fa-github"></i></a></li><li class="twitter"><a href="https://twitter.com/TaylorHakes" target="_blank" title="twitter"><i class="fa fa-twitter"></i></a></li><li class="linkedin"><a href="https://www.linkedin.com/in/taylorhakes" target="_blank" title="linkedin"><i class="fa fa-linkedin"></i></a></li></ul></h3></div></div></div></section><div class="article-end"></div><section data-current-url="" class="next-post"><div class="next-post-wrap"><div class="next-label">Next Story</div><h2 class="post-title"><a href="/posts/a-few-javascript-performance-tips/">A Few Javascript Performance Tips</a></h2><div class="post-meta">May 19, 2013</div><div class="next-arrow"><a href="/posts/a-few-javascript-performance-tips/"><i class="fa fa-angle-double-down"></i></a></div></div></section></main><footer data-layout="wide" class="site-footer one-colum"><div class="site-footer-wrap"><a class="totop-btn"><i class="fa fa-chevron-up"></i></a><div class="footer-social"><ul class="social"><li class="github"><a href="https://github.com/taylorhakes" target="_blank" title="github"><i class="fa fa-github"></i></a></li><li class="twitter"><a href="https://twitter.com/TaylorHakes" target="_blank" title="twitter"><i class="fa fa-twitter"></i></a></li><li class="linkedin"><a href="https://www.linkedin.com/in/taylorhakes" target="_blank" title="linkedin"><i class="fa fa-linkedin"></i></a></li></ul></div><div class="copyright"><p><span>Copyright © 2016 </span><a href="/">Taylor Hakes</a><span> All rights reserved.</span></p></div></div></footer></div></div><script src="https://code.jquery.com/jquery-2.1.4.min.js"></script><script src="/js/bootstrap.min.js"></script><script src="/js/jquery.mb.YTPlayer.js"></script><script src="/js/sdk.js"></script><script src="/js/waveform.js"></script><script src="/js/jquery.fitvids.js"></script><script src="/js/jquery.magnific-popup.min.js"></script><script src="/js/jqBootstrapValidation.js"></script><script src="/js/imagesloaded.pkgd.min.js"></script><script src="/js/moment.min.js"></script><script src="/js/pace.min.js"></script><script src="/js/jquery.placeholder.js"></script><script src="/js/highlight.js"></script><script src="/js/main.js"></script></body></html>